---
name: blueprint-clarify
description: 檢查藍圖是否有過於複雜的階段需要標記，確認邊界定義是否清楚。當藍圖建立後需要快速驗證時使用（簡化版，不做過多互動）。
---

# Blueprint Clarify - 檢查藍圖

快速檢查藍圖，標記複雜階段，確認邊界清楚。

## 核心功能（v0.1 簡化版）

1. **標記複雜階段**：自動偵測並標記
2. **檢查邊界**：確認「邊界定義」清楚
3. **檢查依賴**：找出循環、遺漏、不必要的依賴

## 執行流程

1. **載入藍圖**
   - 讀取 `.blueprint/blueprint.md`
   - 不存在 → 提示先建立藍圖
   - Completed 狀態 → 詢問是否仍要檢查

2. **複雜度檢查**（符合任一即標記）
   - 預期產出 > 5 項
   - 目標含 3+ 個連接詞（「和」、「以及」、「包含」）
   - 可行性提到 3+ 個不相關技術
   - 目標超過 100 字（中文）或 200 字（英文）

   **標記方式**：
   ```markdown
   - **⚠️ 複雜度**: 高 - 此階段包含多個子任務
   - **建議**: 執行時考慮建立子藍圖或細化
   ```

3. **邊界檢查**
   - ✅ 有「包含」和「不包含」清單
   - ⚠️ 缺少「不包含」→ 提醒補充
   - ⚠️ 「包含」太抽象（如「完整系統」）→ 提醒

4. **依賴檢查**

   **a. 循環依賴**（必須修正）
   - 檢查 A → B → A 或更長循環
   - 發現 → 提供修正選項

   **b. 依賴存在性**
   - 檢查「依賴: 階段 N」的階段 N 是否存在
   - 不存在 → 提示修正

   **c. 遺漏依賴**（可疑時詢問）
   - 測試階段「無依賴」→ 可能遺漏（通常依賴實作）
   - API/邏輯「無依賴」但提到「使用資料結構」→ 可能遺漏
   - 整合階段「無依賴」→ 可能遺漏

   **d. 不必要依賴**（建議移除）
   - 前端依賴後端 → 可能不必要（可用 mock）
   - 文件依賴實作 → 合理
   - 部署依賴測試 → 合理

5. **簡單互動**（最多 2-3 個問題，優先順序）
   1. 循環依賴（必須修正）
   2. 複雜階段標記
   3. 遺漏依賴
   4. 邊界定義
   5. 不必要依賴

6. **更新藍圖**
   - 修正循環依賴
   - 更新遺漏/不必要依賴
   - 標記複雜階段
   - 補充邊界定義
   - 記錄檢查結果（時間戳：`[YYYY-MM-DD]`）

7. **輸出摘要**
   ```
   ✓ 藍圖檢查完成

   檢查結果：
   - 複雜階段：1 個（階段 3）
   - 邊界定義：已補充
   - 階段依賴：正常

   ⚠️ 注意：階段 3 較複雜，執行時建議細化

   下一步：/blueprint-ready - 開始實作
   ```

## 注意事項

- 簡化版，最多 2-3 個問題
- 循環依賴必須修正，其他可接受
- 標記而非拆分（避免無止盡巢狀）
- 不改變階段順序（除非修正循環依賴）
