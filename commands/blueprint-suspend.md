---
name: blueprint-suspend
description: 暫停當前進行中的藍圖，移到 suspended 目錄。當需要切換到其他藍圖或暫時不想繼續當前藍圖時使用。
---

# Blueprint Suspend - 暫停藍圖

將當前進行中的藍圖暫停，移到 `suspended/` 目錄，騰出空間給新的藍圖。

## 核心功能

- 暫停當前活躍的藍圖
- 記錄暫停時間和原因（可選）
- 移動到 suspended 目錄並保留所有資訊
- 更新關聯資訊（git branch、beads issues）

## 執行步驟

**重要**：所有檔案操作必須在鎖定下執行（見 `guides/COMMON_PATTERNS.md#鎖定機制`）

1. **檢查當前藍圖**

   - 檢查 `.blueprint/blueprint.md` 是否存在
   - 如果不存在：
     ```
     ❌ 沒有進行中的藍圖可以暫停

     目前沒有活躍的藍圖。
     ```

2. **確認暫停意圖**

   - 讀取藍圖資訊（功能名稱、類型、狀態）
   - 如果使用者只是執行 `/blueprint-suspend` 沒有說明：
     ```
     確定要暫停當前藍圖嗎？

     藍圖：[功能名稱]
     類型：[類型]
     狀態：[當前狀態]

     暫停後可以隨時使用 /blueprint-resume 恢復。
     ```

3. **讀取暫停原因**

   - 如果使用者在訊息中已經說明原因（例如：「暫停這個，我要先處理其他功能」），直接使用
   - 如果沒有提到，不詢問，原因留空

4. **更新關聯資訊（如果需要）**

   - 檢查藍圖的「關聯資訊」區塊
   - 如果 Git Branch 或 Beads Issues 是空的：
     ```
     在暫停前，要更新關聯資訊嗎？（建議，方便恢復時知道要切到哪個 branch）

     目前記錄：
     - Git Branch: [空白或目前的值]
     - Beads Issues: [空白或目前的值]

     選項：
     A. 更新資訊
     B. 跳過
     ```
   - 如果選擇更新：
     - 問：「Git branch 名稱是？（可選）」
     - 問：「相關的 beads issue IDs？（用逗號分隔，例如：beads-123, beads-124）」（可選）
   - 使用 Edit 工具更新藍圖的「關聯資訊」區塊

5. **讀取藍圖資訊**

   - 從藍圖檔案讀取：功能名稱、建立時間、類型
   - 當前日期作為暫停日期

6. **更新藍圖狀態**

   - 使用 Edit 工具在藍圖的「狀態」後面加上：
     ```markdown
     **暫停時間**: 2025-12-24
     **暫停原因**: [原因或留空]
     ```
   - 有原因的格式：
     ```markdown
     **狀態**: In Progress
     **暫停時間**: 2025-12-24
     **暫停原因**: 要先處理其他功能
     ```
   - 沒有原因的格式（保留空欄位）：
     ```markdown
     **狀態**: In Progress
     **暫停時間**: 2025-12-24
     **暫停原因**:
     ```

7. **使用資料夾結構暫停**

   - 使用資料夾結構（見 `guides/COMMON_PATTERNS.md#歸檔資料夾結構`）：
     - 生成資料夾名：`{暫停日期}-{類型}-{slug}`
     - 移動藍圖為 `blueprint.md`
     - 打包 reports/ 和 plans/（如果存在）
   - 回報：
     ```
     ✓ 藍圖已暫停

     資料夾：.blueprint/suspended/{資料夾名}/
     類型：{類型}
     功能：{功能名稱}
     暫停原因：{原因}（如果有）

     關聯資訊：
     - Git Branch: {branch}（如果有）
     - Beads Issues: {issues}（如果有）

     現在可以開始新的藍圖，或使用 /blueprint-resume 恢復暫停的藍圖。
     ```

## 暫停後的藍圖格式

```markdown
# Blueprint: 使用者認證系統

**建立時間**: 2025-12-20
**類型**: feat
**狀態**: In Progress
**暫停時間**: 2025-12-24
**暫停原因**: 要先處理其他功能

**關聯資訊**:
- Git Branch: feature/user-auth
- Beads Issues: beads-123

## 功能描述
...

## 階段規劃
[原本的規劃保持不變，包含階段狀態]
```

## 注意事項

- 暫停不會改變藍圖的「狀態」欄位（保持 Draft/In Progress）
- 只是加上「暫停時間」和「暫停原因」標記
- 所有階段進度都會保留
- 暫停時建議更新關聯資訊，方便恢復時知道要切到哪個 branch
- 檔名中的日期是「暫停日期」而非「建立日期」
